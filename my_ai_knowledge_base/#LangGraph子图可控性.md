# #LangGraphå­å›¾å¯æ§æ€§** **  
ä¸‹é¢æˆ‘ç»™ä½ ä¸€ä»½ ****å·¥ç¨‹çº§ã€å®ç”¨çš„ã€ŠLangGraph å­å›¾ï¼ˆSubGraphï¼‰å¯æ§æ€§æŒ‡å—ã€‹****ï¼Œå¸®ä½ ç†è§£å’Œè½åœ°å¦‚ä½•åœ¨å¤æ‚å·¥ä½œæµä¸­ç®¡ç†å­å›¾æ‰§è¡Œã€è·¯ç”±æ§åˆ¶ã€çŠ¶æ€å…±äº«å’Œä¸­æ–­æ¢å¤ã€‚  
  
## ğŸš€** ä¸€ã€LangGraph å­å›¾ï¼ˆSubGraphï¼‰æ˜¯ä»€ä¹ˆï¼Ÿ**  
åœ¨ LangGraph ä¸­ï¼š  
* ****å­å›¾ï¼ˆSubGraphï¼‰ = ç‹¬ç«‹å¯æ‰§è¡Œçš„ Graphï¼Œå¯ä»¥åµŒå…¥åˆ°ä¸» Graph ä¸­ä½œä¸ºèŠ‚ç‚¹æ‰§è¡Œ****  
* æ”¯æŒè‡ªå·±çš„ Stateã€èŠ‚ç‚¹ã€Edge  
* å¯ä»¥å’Œä¸»å›¾å…±äº« State æˆ–éƒ¨åˆ† State  
* å¯ä»¥ç‹¬ç«‹ checkpointã€æµå¼æ‰§è¡Œã€HITL ä¸­æ–­  
ä½œç”¨ï¼š  
* æ‹†åˆ†å¤æ‚ä»»åŠ¡ â†’ å¯å¤ç”¨æ¨¡å—åŒ–  
* å¤æ‚ ReAct / RAG å·¥ä½œæµ â†’ æ¯ä¸ªå­æµç¨‹ç‹¬ç«‹å¯æ§  
* æ”¯æŒå¤šä»£ç†åä½œ â†’ æ¯ä¸ªä»£ç†å¯ä»¥æ˜¯ä¸€ä¸ªå­å›¾  
* æ”¯æŒæ–­ç‚¹ç»­è·‘ â†’ å­å›¾å¯å•ç‹¬ resume  
  
## ğŸ§±** äºŒã€å­å›¾å¯æ§æ€§æ ¸å¿ƒæ¦‚å¿µ**  
1. **Entry / Exit**  
    * å­å›¾å¯ä»¥å®šä¹‰å…¥å£èŠ‚ç‚¹å’Œå‡ºå£èŠ‚ç‚¹  
    * ä¸»å›¾è°ƒç”¨å­å›¾æ—¶ï¼Œåªå…³å¿ƒå…¥å£ä¸å‡ºå£  
2. **State ç®¡ç†**  
    * å­å›¾å¯ä»¥å…±äº«ä¸»å›¾ State  
    * æˆ–ä½¿ç”¨è‡ªå·±çš„å±€éƒ¨ Stateï¼ˆå¯å¤ç”¨å­å›¾ï¼‰  
3. **Checkpoint æ”¯æŒ**  
    * å­å›¾æ‰§è¡Œå¯å•ç‹¬ checkpoint  
    * ä¸»å›¾ checkpoint ä¼šåŒ…å«å­å›¾çŠ¶æ€å¿«ç…§  
4. **Interrupt / Send**  
    * å­å›¾å†…å¯ HITL ä¸­æ–­ï¼Œå¤–éƒ¨é€šè¿‡ send ç»§ç»­æ‰§è¡Œ  
    * å­å›¾ä¸­æ–­ä¸ä¼šå½±å“ä¸»å›¾æœªå®ŒæˆèŠ‚ç‚¹ï¼Œå¯æ¢å¤  
5. **Conditional Edge / Router**  
    * å­å›¾å‡ºå£å¯ä»¥æ ¹æ®å†…éƒ¨çŠ¶æ€è¿”å›ä¸åŒç»“æœ  
    * ä¸»å›¾æ ¹æ®è¿”å›å€¼è·¯ç”±åˆ°ä¸åŒèŠ‚ç‚¹  
  
## ğŸ§ ** ä¸‰ã€å­å›¾å¯æ§æ€§çš„å…¸å‹ä½¿ç”¨æ¨¡å¼**  
## **1ï¼‰æ¨¡å—åŒ– ReAct**  
* ä¸»å›¾ï¼šPlanner â†’ å­å›¾ Executor â†’ Critic  
* Executor å­å›¾å†…éƒ¨æ‰§è¡Œ RAG + å·¥å…·  
* å­å›¾å¯å•ç‹¬æµå¼æ‰§è¡Œã€HITL ä¸­æ–­ã€checkpoint  
## **2ï¼‰å¤šä»£ç†åä½œ**  
* æ¯ä¸ªä»£ç†å¯¹åº”ä¸€ä¸ªå­å›¾  
* ä¸»å›¾åªè´Ÿè´£è·¯ç”±å’ŒçŠ¶æ€å…±äº«  
* å­å›¾å†…ç‹¬ç«‹æ‰§è¡Œ workflowã€å¯å¤ç”¨  
## **3ï¼‰ä»»åŠ¡æ‹†è§£ä¸å¤ç”¨**  
* ä¸»å›¾è°ƒç”¨å­å›¾æ‰§è¡Œå­ä»»åŠ¡  
* å­å›¾è¿”å›å­ä»»åŠ¡ç»“æœ  
* ä¸»å›¾æ ¹æ®å­å›¾ç»“æœåŠ¨æ€è·¯ç”±åˆ°ä¸‹ä¸€ä»»åŠ¡  
  
## ğŸ§©** å››ã€å­å›¾å®ç°ç¤ºä¾‹**  
## **1ï¼‰å®šä¹‰å­å›¾**  
```
from langgraph.graph import StateGraph, END
from typing import TypedDict

class SubState(TypedDict):
    sub_input: str
    sub_result: str

def sub_node1(state: SubState):
    # æ¨¡æ‹Ÿå¤„ç†
    return {"sub_result": f"å¤„ç† {state['sub_input']}"}

subgraph = StateGraph(SubState)
subgraph.add_node("sub_node1", sub_node1)
subgraph.set_entry_point("sub_node1")
subgraph.add_edge("sub_node1", END)

```
  
## **2ï¼‰ä¸»å›¾è°ƒç”¨å­å›¾**  
```
from typing import TypedDict

class MainState(TypedDict):
    main_input: str
    subgraph_output: str

def call_subgraph(state: MainState):
    # å°†ä¸»å›¾çŠ¶æ€ä¼ ç»™å­å›¾
    sub_state = {"sub_input": state["main_input"]}
    # æ‰§è¡Œå­å›¾
    sub_result = subgraph.invoke(sub_state)
    return {"subgraph_output": sub_result["sub_result"]}

main_graph = StateGraph(MainState)
main_graph.add_node("call_subgraph", call_subgraph)
main_graph.set_entry_point("call_subgraph")
main_graph.add_edge("call_subgraph", END)

app = main_graph.compile()

```
  
## **3ï¼‰è¿è¡Œå¹¶å¯æ§**  
```
out = app.invoke({"main_input": "å­ä»»åŠ¡A"})
print(out)
# è¾“å‡º: {'subgraph_output': 'å¤„ç† å­ä»»åŠ¡A'}

```
* å¯åœ¨å­å›¾å†…éƒ¨åŠ  checkpoint  
* å¯åœ¨å­å›¾å†…éƒ¨ä¸­æ–­ç­‰å¾…ç”¨æˆ·è¾“å…¥  
* å­å›¾å¯ç‹¬ç«‹æµå¼è¾“å‡º token  
* å­å›¾è¿”å›ç»“æœåä¸»å›¾ç»§ç»­ä¸‹ä¸€èŠ‚ç‚¹  
  
## ğŸ”§** äº”ã€å­å›¾å¯æ§æ€§å¼ºåŒ–æŠ€å·§**  
1. **å±€éƒ¨ State + å…¨å±€ State**  
    * å­å›¾ç‹¬ç«‹ç®¡ç†å¤æ‚æµç¨‹çŠ¶æ€  
    * ä¸»å›¾åªç®¡ç†å…¨å±€å˜é‡å’Œè·¯ç”±  
    * é¿å…çŠ¶æ€æ±¡æŸ“  
2. **Checkpoint**  
    * å­å›¾ç‹¬ç«‹ checkpoint  
    * ä¸»å›¾ checkpoint å¯åŒ…å«å­å›¾ snapshot  
    * æ”¯æŒæ–­ç‚¹ç»­è·‘  
3. **Interrupt + Send**  
    * å­å›¾å†…ä»»æ„èŠ‚ç‚¹å¯ HITL ä¸­æ–­  
    * send å¯ä»ä¸­æ–­ç‚¹ç»§ç»­æ‰§è¡Œå­å›¾  
    * ä¸»å›¾ä¸å—å½±å“  
4. **Conditional Exit / Router**  
    * å­å›¾å‡ºå£å¯æ ¹æ®çŠ¶æ€è¿”å›ä¸åŒç»“æœ  
    * ä¸»å›¾å¯åŠ¨æ€é€‰æ‹©ä¸‹ä¸€èŠ‚ç‚¹  
    * æ”¯æŒå¤æ‚å¤šä»£ç†åä½œ  
5. **æµå¼è¾“å‡º**  
    * å­å›¾èŠ‚ç‚¹å¯æµå¼è¾“å‡º token / äº‹ä»¶  
    * ä¸»å›¾å¯æ±‡æ€»å¤šå­å›¾è¾“å‡ºåˆ°å‰ç«¯æˆ–æ—¥å¿—ç³»ç»Ÿ  
  
## ğŸ¯** å…­ã€æ€»ç»“**  
**LangGraph å­å›¾å¯æ§æ€§ = å¯ç‹¬ç«‹æ‰§è¡Œ + ç‹¬ç«‹ checkpoint + HITL ä¸­æ–­ + çŠ¶æ€å¯å…±äº« + æ¡ä»¶è·¯ç”±**ã€‚  
* ****ä¼˜åŠ¿****ï¼šå¤æ‚å·¥ä½œæµæ‹†è§£ã€ä»»åŠ¡å¤ç”¨ã€å¤šä»£ç†åä½œã€å¯æ¢å¤æ‰§è¡Œã€å¯æµå¼è¾“å‡º  
* ****æ ¸å¿ƒ****ï¼šå­å›¾æ˜¯ä¸»å›¾çš„å¯æ§æ¨¡å—ï¼Œæ”¯æŒç‹¬ç«‹è§‚å¯Ÿã€ç‹¬ç«‹ä¸­æ–­ã€ç‹¬ç«‹æµå¼  
* ****å…¸å‹åœºæ™¯****ï¼šReAct workflowã€RAG + Tool workflowã€å¤šä»£ç†ä»»åŠ¡åä½œ  
ä¸€å¥è¯ï¼š  
****å­å›¾ = å¯æ§ã€å¯å¤ç”¨ã€å¯ä¸­æ–­ã€å¯æ¢å¤çš„æ¨¡å—åŒ–æ™ºèƒ½ä½“æ‰§è¡Œå•å…ƒã€‚****  
****å­å›¾ = å¯æ§ã€å¯å¤ç”¨ã€å¯ä¸­æ–­ã€å¯æ¢å¤çš„æ¨¡å—åŒ–æ™ºèƒ½ä½“æ‰§è¡Œå•å…ƒã€‚****  
  
æˆ‘å¯ä»¥è¿›ä¸€æ­¥ç»™ä½ æ•´ç†ä¸€ä¸ªï¼š  
## ğŸ”¹** â€œLangGraph å¤šå­å›¾ + å¤šä»£ç†åä½œ + HITL + ReAct + RAG å®Œæ•´ç¤ºä¾‹é¡¹ç›®æ¨¡æ¿â€**  
ä½ å¸Œæœ›æˆ‘ç›´æ¥ç»™è¿™ä¸ªç¤ºä¾‹å—ï¼Ÿ  
