# #LangGraphæ£€æŸ¥ç‚¹ä¸Sendæœºåˆ¶** **  
ä¸‹é¢æˆ‘ç»™ä½ ä¸€ä»½ ****å·¥ç¨‹çº§ã€æ·±å…¥åˆ°åº•çš„ã€ŠLangGraph æ£€æŸ¥ç‚¹ï¼ˆCheckpointï¼‰ä¸ Send æœºåˆ¶å®Œå…¨æŒ‡å—ã€‹****ã€‚â€¨è¿™ä¸¤ä¸ªèƒ½åŠ›æ˜¯ LangGraph çš„çµé­‚ï¼Œè®© Agent èƒ½å®ç°ï¼š  
* ****ä¸­æ–­ï¼ˆInterruptï¼‰****  
* ****æ¢å¤æ‰§è¡Œï¼ˆResumeï¼‰****  
* ****äººæœºäº¤äº’ï¼ˆHITLï¼‰****  
* ****å¤šè½®å¯¹è¯æŒä¹…åŒ–****  
* ****å¤šèŠ‚ç‚¹å¤æ‚æµç¨‹æ–­ç‚¹ç»­è·‘****  
* ****å¯è¿½æº¯çš„æ‰§è¡Œè½¨è¿¹ï¼ˆauditï¼‰****  
ä½ å®Œå…¨æŒæ¡è¿™ä¸¤ç‚¹ï¼ŒLangGraph 80% çš„æ ¸å¿ƒèƒ½åŠ›å°±åƒé€äº†ã€‚  
  
## ğŸš€** ä¸€ã€æ£€æŸ¥ç‚¹ï¼ˆCheckpointï¼‰æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸€å¥è¯æœ¬è´¨ï¼‰**  
**Checkpoint = LangGraph åœ¨æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œåä¿å­˜çš„â€œçŠ¶æ€å¿«ç…§ï¼ˆState Snapshotï¼‰â€ï¼Œç”¨äºæ¢å¤ã€å›æ”¾ã€ç»§ç»­æ‰§è¡Œã€‚**  
å®ƒè®°å½•ï¼š  
* å½“å‰ Stateï¼ˆæ¶ˆæ¯ã€å˜é‡ã€ä¸Šä¸‹æ–‡ï¼‰  
* å›¾æ‰§è¡Œè¿›åº¦ï¼ˆå½“å‰åœ¨å“ªä¸ªèŠ‚ç‚¹ï¼‰  
* èŠ‚ç‚¹è¾“å‡º  
* å·¥å…·ç»“æœ  
* äº‹ä»¶å†å²ï¼ˆEvent Logï¼‰  
Checkpoint æ˜¯ LangGraph èƒ½åš â€œæ¢å¤æ‰§è¡Œ (resume)â€ çš„æ ¹åŸºã€‚  
  
## ğŸ§±** äºŒã€Send æ˜¯ä»€ä¹ˆï¼Ÿï¼ˆä¸€å¥è¯æœ¬è´¨ï¼‰**  
**Send = ç”¨æˆ·å‘å›¾å‘é€ä¸€ä¸ªäº‹ä»¶/é¢å¤– stateï¼Œè®©å›¾ä»ä¸Šä¸€ä¸ªä¸­æ–­ç‚¹ç»§ç»­æ‰§è¡Œã€‚**  
åœ¨ HITLï¼ˆäººæœºäº¤äº’ï¼‰åœºæ™¯ä¸­éå¸¸é‡è¦ï¼š  
* AI åœ¨æŸä¸€æ­¥åœæ­¢å¹¶ç­‰å¾…ç”¨æˆ·  
* ç”¨æˆ·è¾“å…¥ï¼ˆæŸäº›å­—æ®µï¼‰  
* ä½¿ç”¨ send() æ¢å¤æ‰§è¡Œ  
è¿™ä¸ªæœºåˆ¶æœ¬è´¨ä¸Šå°±æ˜¯ï¼š  
```
ä¸­æ–­ --> ç”¨æˆ·è¡¥å……ä¿¡æ¯ --> ç»§ç»­æ‰§è¡Œ

```
  
## ğŸ“Œ** ä¸‰ã€ä¸ºä»€ä¹ˆ LangGraph å¿…é¡»æœ‰ Checkpoint + Sendï¼Ÿ**  
å› ä¸º LLM/Agent å·¥ä½œæµä¸åƒæ™®é€šå‡½æ•°è°ƒç”¨ï¼š  
* æœ‰å¤šèŠ‚ç‚¹  
* æœ‰å¾ªç¯  
* æœ‰ä¸­æ–­  
* æœ‰ç”¨æˆ·äº¤äº’  
* æœ‰å·¥å…·è°ƒç”¨  
* æœ‰å¤±è´¥é‡è¯•  
ä½ æ— æ³•ä¸€æ¬¡æ€§æ‰§è¡Œå®Œã€‚  
Checkpoint + Send è®© AI å˜æˆä¸€ä¸ªçœŸæ­£çš„â€œçŠ¶æ€æœºå·¥ä½œæµâ€ï¼ˆstateful workflowï¼‰ã€‚  
  
## ğŸ§ ** å››ã€Checkpoint å·¥ä½œåŸç†å…¨è§£æ**  
## âœ”** 1ï¼‰æ¯ä¸ªèŠ‚ç‚¹æ‰§è¡Œå®Œéƒ½ä¼šç”Ÿæˆ checkpoint**  
ä¾‹å¦‚ workflowï¼š  
```
Node A â†’ Node B â†’ Node C

```
LangGraph åœ¨ Aã€Bã€C æ¯å¤„éƒ½ä¼š checkpointã€‚  
å†…å®¹åŒ…æ‹¬ï¼š  
* å½“å‰ state  
* å½“å‰æ‰§è¡ŒèŠ‚ç‚¹  
* è¾“å…¥è¾“å‡ºæ¶ˆæ¯  
* è¿è¡Œæ—¶é—´æˆ³  
* çº¿ç¨‹ ID / ä¼šè¯ IDï¼ˆthread_idï¼‰  
  
## âœ”** 2ï¼‰æŒä¹…åŒ–æ–¹å¼**  
å¯ä»¥é€‰ï¼š  
* MemorySaverï¼ˆå†…å­˜ï¼‰  
* FileCheckpointerï¼ˆæ–‡ä»¶ï¼‰  
* SQLite/Postgresï¼ˆç”Ÿäº§æ¨èï¼‰  
* è‡ªå®šä¹‰ Redis/Mongo  
ä¾‹å¦‚ SQLiteï¼š  
```
from langgraph.checkpoint.sqlite import SqliteSaver
checkpointer = SqliteSaver.from_uri("sqlite:///graph.db")
app = graph.compile(checkpointer=checkpointer)

```
  
## âœ”** 3ï¼‰Checkpoint æ”¯æŒæ¢å¤**  
ä»æŒ‡å®š checkpoint æ¢å¤æ‰§è¡Œï¼š  
```
app.resume(
    config={"thread_id": "user-01"}
)

```
å¦‚æœ workflow è¢«ä¸­æ–­è¿‡ï¼š  
```
app.resume(config={"thread_id":"u01", "checkpoint":"step-3"})

```
  
## ğŸ§±** äº”ã€Send å·¥ä½œåŸç†å…¨è§£æ**  
Send typically follows an Interrupt.  
## âœ”** 1ï¼‰èŠ‚ç‚¹ä¸»åŠ¨ä¸­æ–­**  
åœ¨èŠ‚ç‚¹ä¸­ï¼š  
```
from langgraph.types import Interrupt

def wait_user(state):
    raise Interrupt("need_user_input")

```
æ‰§è¡Œè¿™ä¸ªèŠ‚ç‚¹æ—¶ï¼Œworkflow åœä½ï¼Œå‰ç«¯æ”¶åˆ°äº‹ä»¶ï¼š  
```
interrupt_event: need_user_input

```
ä»£è¡¨éœ€è¦ç”¨æˆ·è¾“å…¥ã€‚  
  
## âœ”** 2ï¼‰ç”¨æˆ·é€šè¿‡ send è¡¥å……ä¿¡æ¯**  
ä¾‹å¦‚ç”¨æˆ·è¾“å…¥ï¼š  
```
yes

```
ä½ æ¢å¤æ‰§è¡Œï¼š  
```
app.send(
    {"user_confirm": True},
    config={"thread_id": "u01"}
)

```
Send åšäº†ä¸¤ä»¶äº‹ï¼š  
## ğŸŸ¦** â‘  æŠŠç”¨æˆ·è¾“å…¥åˆå¹¶åˆ° State**  
ä¾‹å¦‚ï¼š  
åŸæ¥ stateï¼š  
```
{"messages":[...], "user_confirm": None}

```
send è¾“å…¥ï¼š  
```
{"user_confirm": True}

```
åˆå¹¶çŠ¶æ€ï¼š  
```
{"messages":[...], "user_confirm": True}

```
## ğŸŸ¦** â‘¡ ä»æœ€è¿‘çš„ checkpoint ç»§ç»­æ‰§è¡Œå·¥ä½œæµ**  
æ¢å¤åˆ°ä¸­æ–­ç‚¹ç»§ç»­å¾€ä¸‹æ‰§è¡Œã€‚  
æ²¡æœ‰ checkpointï¼Œè¿™ä¸€åˆ‡éƒ½åšä¸åˆ°ã€‚  
  
## ğŸ”¥** å…­ã€å®Œæ•´ Demo å±•ç¤ºä¸¤è€…å¦‚ä½•åä½œ**  
è¿™æ˜¯å¯è¿è¡Œçš„æœ€å°ä¾‹å­ã€‚  
  
## âœ”** Step 1ï¼šå®šä¹‰ State**  
```
class State(TypedDict):
    messages: List
    user_confirm: bool

```
  
## âœ”** Step 2ï¼šèŠ‚ç‚¹ï¼šé—®ç”¨æˆ·**  
```
def ask_user(state):
    msg = AIMessage("éœ€è¦ç»§ç»­å—ï¼Ÿyes/no")
    return {"messages": state["messages"] + [msg]}

```
  
## âœ”** Step 3ï¼šèŠ‚ç‚¹ï¼šä¸­æ–­ç­‰å¾…ç”¨æˆ·**  
```
from langgraph.types import Interrupt

def wait_user(state):
    raise Interrupt("need_user_input")

```
  
## âœ”** Step 4ï¼šèŠ‚ç‚¹ï¼šç»§ç»­æ‰§è¡Œ**  
```
def continue_step(state):
    return {
        "messages": state["messages"] + [AIMessage("ç»§ç»­æ‰§è¡Œä»»åŠ¡")]
    }

```
  
## âœ”** Step 5ï¼šæ„å»º Graph**  
```
graph = StateGraph(State)

graph.add_node("ask", ask_user)
graph.add_node("wait", wait_user)
graph.add_node("continue", continue_step)

graph.set_entry_point("ask")

graph.add_edge("ask", "wait")

graph.add_conditional_edges(
    "wait",
    lambda s: "continue" if s.get("user_confirm") else END,
)

```
  
## âœ”** Step 6ï¼šè¿è¡Œï¼ˆStreaming + Checkpointï¼‰**  
```
events = app.stream(
    {"messages":[HumanMessage("å¼€å§‹")]},
    config={"thread_id": "u01"}
)

for e in events:
    print(e)

```
å‡ºç°ï¼š  
```
AIï¼šéœ€è¦ç»§ç»­å—ï¼Ÿyes/no
interrupt: need_user_input

```
åœä½ã€‚  
  
## âœ”** Step 7ï¼šç”¨æˆ·å“åº”ï¼Œé€šè¿‡ send æ¢å¤æ‰§è¡Œ**  
```
events = app.send(
    {"user_confirm": True},
    config={"thread_id":"u01"}
)

```
è¾“å‡ºï¼š  
```
AI: ç»§ç»­æ‰§è¡Œä»»åŠ¡

```
  
## ğŸŒŸ** ä¸ƒã€ä¸ºä»€ä¹ˆè¿™æ˜¯ AI/Agent å·¥ä½œæµä¸­æœ€é‡è¦çš„èƒ½åŠ›ï¼Ÿ**  
å› ä¸º Agent ä¸åªæ˜¯èŠå¤©ï¼Œå®ƒéœ€è¦ï¼š  
* äººæœºå®¡é˜…  
* æ•°æ®è¡¥å…¨  
* å®‰å…¨ç¡®è®¤  
* é•¿é“¾è·¯è‡ªåŠ¨åŒ–ä»»åŠ¡  
* å¤šæ­¥éª¤å·¥å…·ä½¿ç”¨  
* å¤æ‚æ¨ç†  
* æŒä¹…ä¼šè¯ç®¡ç†  
* ä¸­æ–­ & æ¢å¤  
æ²¡æœ‰ Checkpoint + Send çš„æ¡†æ¶åšä¸åˆ°è¿™äº›ã€‚  
LangGraph æ˜¯ä¸ºâ€œå¯æ§ Agentâ€è€Œè®¾è®¡çš„ï¼Œä¸æ˜¯ä¸ºâ€œç®€å•èŠå¤©â€è®¾è®¡çš„ã€‚  
  
## ğŸ§©** å…«ã€å¸¸è§å®é™…åº”ç”¨ï¼ˆç”Ÿäº§åœºæ™¯ï¼‰**  
## âœ”** 1ï¼‰RAG: ç”¨æˆ·è¡¥å……ç¼ºå¤±ä¿¡æ¯**  
æ£€ç´¢ä¸åˆ°è¶³å¤Ÿå†…å®¹ â†’ ä¸­æ–­ â†’ ç­‰ç”¨æˆ·è¡¥å…… â†’ send æ¢å¤ã€‚  
## âœ”** 2ï¼‰SQL Agent: ç”¨æˆ·ç¡®è®¤ SQL**  
AI ç”Ÿæˆ SQL â†’ ä¸­æ–­è¯¢é—® â†’ ç”¨æˆ·ç¡®è®¤ â†’ send æ‰§è¡Œã€‚  
## âœ”** 3ï¼‰å¤š Agent è°ƒç”¨**  
Router â†’ Interrupt â†’ äººç±»é€‰æ‹© â†’ send ç»§ç»­æ‰§è¡Œã€‚  
## âœ”** 4ï¼‰é•¿ä»»åŠ¡æ‰§è¡Œ**  
æ‰§è¡Œåˆ°ç¬¬ 4 æ­¥æœåŠ¡å™¨æ–­ç”µ â†’ resume ç»§ç»­ã€‚  
## âœ”** 5ï¼‰è¡¨å•å¼å¯¹è¯**  
AI é€æ­¥é‡‡é›†å­—æ®µï¼Œä¸­æ–­â€“å¡«å†™â€“ç»§ç»­ã€‚  
è¿™å°±æ˜¯æ„å»º GPTs / æ™ºèƒ½åŠ©æ‰‹ / ä¼ä¸š Agent çš„æ ¸å¿ƒèƒ½åŠ›ã€‚  
  
## ğŸ¯** ä¹ã€æ€»ç»“ï¼ˆæŠ“ä½æœ¬è´¨ï¼‰**  
## âœ”** Checkpointï¼š**  
ä¿å­˜çŠ¶æ€ï¼Œæ”¯æŒå·¥ä½œæµæ¢å¤ã€å›æ”¾ã€å®¡è®¡ã€é•¿ä»»åŠ¡ã€‚  
## âœ”** Sendï¼š**  
ä»ä¸­æ–­ç‚¹ç»§ç»­æ‰§è¡Œï¼Œæ”¯æŒäººæœºäº¤äº’ã€‚  
## âœ”** ä¸¤è€…é…åˆï¼š**  
æ„æˆå®Œæ•´çš„ â€œå¯æ§å‹ Agent å·¥ä½œæµâ€ã€‚  
ä¸€å¥è¯æ€»ç»“ï¼š  
**Checkpoint è´Ÿè´£è®°ä½è¿‡å»ï¼ŒSend è´Ÿè´£ç»§ç»­æœªæ¥ã€‚â€¨LangGraph ç”±æ­¤å…·å¤‡â€œå¯æ¢å¤çš„æ™ºèƒ½ä½“æ‰§è¡Œèƒ½åŠ›â€ã€‚**  
  
å¦‚æœä½ æ„¿æ„ï¼Œæˆ‘å¯ä»¥ç»§ç»­ä¸ºä½ ç”Ÿæˆï¼š  
## ğŸ”¥** A. LangGraph + RAG + Checkpoint + Send çš„å®Œæ•´ä¼ä¸šçº§é¡¹ç›®**  
## ğŸ”¥** B. LangGraph ç”¨æˆ·å¤šè½®å¯¹è¯æŒä¹…åŒ–ç¤ºä¾‹**  
## ğŸ”¥** C. ç”¨ Checkpoint å®ç°â€œå¤š Agent ä½œä¸šæµè°ƒåº¦â€**  
## ğŸ”¥** D. å‰ç«¯ï¼ˆNext.jsï¼‰å¦‚ä½•å¯¹æ¥ Send/Stream äº‹ä»¶**  
## ğŸ”¥** E. DeepSeek R1 + LangGraph çš„å…¨é“¾è·¯å¯æ§ Agent**  
ä½ æƒ³çœ‹å“ªä¸€ä¸ªï¼Ÿ  
